<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/abstract-leveldown/README.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#abstract-leveldown">abstract-leveldown</a>
      </div>

      <div class="heading h2">
        <a href="#table-of-contents">Table of Contents</a>
      </div>

      <div class="heading h2">
        <a href="#background">Background</a>
      </div>

      <div class="heading h2">
        <a href="#example">Example</a>
      </div>

      <div class="heading h2">
        <a href="#browser-support">Browser Support</a>
      </div>

      <div class="heading h2">
        <a href="#public-api-for-consumers">Public API For Consumers</a>
      </div>

      <div class="heading h3">
        <a href="#db-constructor..">db = constructor(..)</a>
      </div>

      <div class="heading h3">
        <a href="#db.status">db.status</a>
      </div>

      <div class="heading h3">
        <a href="#db.supports">db.supports</a>
      </div>

      <div class="heading h3">
        <a href="#db.open-options-callback">db.open([options, ]callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db.close-callback">db.close(callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db.get-key-options-callback">db.get(key[, options], callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db.put-key-value-options-callback">db.put(key, value[, options], callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db.del-key-options-callback">db.del(key[, options], callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db.batch-operations-options-callback">db.batch(operations[, options], callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db.batch">db.batch()</a>
      </div>

      <div class="heading h3">
        <a href="#db.iterator-options">db.iterator([options])</a>
      </div>

      <div class="heading h3">
        <a href="#db.clear-options-callback">db.clear([options, ]callback)</a>
      </div>

      <div class="heading h3">
        <a href="#chainedbatch">chainedBatch</a>
      </div>

      <div class="heading h4">
        <a href="#chainedbatch.put-key-value">chainedBatch.put(key, value)</a>
      </div>

      <div class="heading h4">
        <a href="#chainedbatch.del-key">chainedBatch.del(key)</a>
      </div>

      <div class="heading h4">
        <a href="#chainedbatch.clear">chainedBatch.clear()</a>
      </div>

      <div class="heading h4">
        <a href="#chainedbatch.write-options-callback">chainedBatch.write([options, ]callback)</a>
      </div>

      <div class="heading h4">
        <a href="#chainedbatch.db">chainedBatch.db</a>
      </div>

      <div class="heading h3">
        <a href="#iterator">iterator</a>
      </div>

      <div class="heading h4">
        <a href="#iterator.next-callback">iterator.next(callback)</a>
      </div>

      <div class="heading h4">
        <a href="#iterator.seek-target">iterator.seek(target)</a>
      </div>

      <div class="heading h4">
        <a href="#iterator.end-callback">iterator.end(callback)</a>
      </div>

      <div class="heading h4">
        <a href="#iterator.db">iterator.db</a>
      </div>

      <div class="heading h3">
        <a href="#type-support">Type Support</a>
      </div>

      <div class="heading h2">
        <a href="#private-api-for-implementors">Private API For Implementors</a>
      </div>

      <div class="heading h3">
        <a href="#db-abstractleveldown-manifest">db = AbstractLevelDOWN([manifest])</a>
      </div>

      <div class="heading h3">
        <a href="#db._open-options-callback">db._open(options, callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db._close-callback">db._close(callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db._serializekey-key">db._serializeKey(key)</a>
      </div>

      <div class="heading h3">
        <a href="#db._serializevalue-value">db._serializeValue(value)</a>
      </div>

      <div class="heading h3">
        <a href="#db._get-key-options-callback">db._get(key, options, callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db._put-key-value-options-callback">db._put(key, value, options, callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db._del-key-options-callback">db._del(key, options, callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db._batch-operations-options-callback">db._batch(operations, options, callback)</a>
      </div>

      <div class="heading h3">
        <a href="#db._chainedbatch">db._chainedBatch()</a>
      </div>

      <div class="heading h3">
        <a href="#db._iterator-options">db._iterator(options)</a>
      </div>

      <div class="heading h3">
        <a href="#db._clear-options-callback">db._clear(options, callback)</a>
      </div>

      <div class="heading h3">
        <a href="#iterator-abstractiterator-db">iterator = AbstractIterator(db)</a>
      </div>

      <div class="heading h4">
        <a href="#iterator._next-callback">iterator._next(callback)</a>
      </div>

      <div class="heading h4">
        <a href="#iterator._seek-target">iterator._seek(target)</a>
      </div>

      <div class="heading h4">
        <a href="#iterator._end-callback">iterator._end(callback)</a>
      </div>

      <div class="heading h3">
        <a href="#chainedbatch-abstractchainedbatch-db">chainedBatch = AbstractChainedBatch(db)</a>
      </div>

      <div class="heading h4">
        <a href="#chainedbatch._put-key-value">chainedBatch._put(key, value)</a>
      </div>

      <div class="heading h4">
        <a href="#chainedbatch._del-key">chainedBatch._del(key)</a>
      </div>

      <div class="heading h4">
        <a href="#chainedbatch._clear">chainedBatch._clear()</a>
      </div>

      <div class="heading h4">
        <a href="#chainedbatch._write-options-callback">chainedBatch._write(options, callback)</a>
      </div>

      <div class="heading h2">
        <a href="#test-suite">Test Suite</a>
      </div>

      <div class="heading h3">
        <a href="#excluding-tests">Excluding tests</a>
      </div>

      <div class="heading h3">
        <a href="#setup-and-teardown">Setup and teardown</a>
      </div>

      <div class="heading h3">
        <a href="#reusing-testcommon">Reusing testCommon</a>
      </div>

      <div class="heading h2">
        <a href="#spread-the-word">Spread The Word</a>
      </div>

      <div class="heading h2">
        <a href="#install">Install</a>
      </div>

      <div class="heading h2">
        <a href="#contributing">Contributing</a>
      </div>

      <div class="heading h2">
        <a href="#big-thanks">Big Thanks</a>
      </div>

      <div class="heading h2">
        <a href="#donate">Donate</a>
      </div>

      <div class="heading h3">
        <a href="#backers">Backers</a>
      </div>

      <div class="heading h3">
        <a href="#sponsors">Sponsors</a>
      </div>

      <div class="heading h2">
        <a href="#license">License</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="abstract-leveldown">
  <h1>
    <a href="#abstract-leveldown" name="abstract-leveldown" class="pilcrow"></a>
abstract-leveldown
  </h1>
</div>
<blockquote>
<p>An abstract prototype matching the <a href="https://github.com/Level/leveldown"><code>leveldown</code></a> API. Useful for extending <a href="https://github.com/Level/levelup"><code>levelup</code></a> functionality by providing a replacement to <code>leveldown</code>.</p>
</blockquote>
<p><a href="https://github.com/Level/awesome"><img src="https://leveljs.org/img/badge.svg" alt="level badge"></a>
<a href="https://www.npmjs.com/package/abstract-leveldown"><img src="https://img.shields.io/npm/v/abstract-leveldown.svg?label=&amp;logo=npm" alt="npm"></a>
<a href="https://www.npmjs.com/package/abstract-leveldown"><img src="https://img.shields.io/node/v/abstract-leveldown.svg" alt="Node version"></a>
<a href="https://travis-ci.com/Level/abstract-leveldown"><img src="https://img.shields.io/travis/com/Level/abstract-leveldown.svg?logo=travis&amp;label=" alt="Travis"></a>
<a href="https://coveralls.io/github/Level/abstract-leveldown"><img src="https://coveralls.io/repos/github/Level/abstract-leveldown/badge.svg" alt="Coverage Status"></a>
<a href="https://standardjs.com"><img src="https://img.shields.io/badge/code_style-standard-brightgreen.svg" alt="JavaScript Style Guide"></a>
<a href="https://www.npmjs.com/package/abstract-leveldown"><img src="https://img.shields.io/npm/dm/abstract-leveldown.svg?label=dl" alt="npm"></a>
<a href="#backers.html"><img src="https://opencollective.com/level/backers/badge.svg?color=orange" alt="Backers on Open Collective"></a>
<a href="#sponsors.html"><img src="https://opencollective.com/level/sponsors/badge.svg?color=orange" alt="Sponsors on Open Collective"></a></p>
<div class="pilwrap" id="table-of-contents">
  <h2>
    <a href="#table-of-contents" name="table-of-contents" class="pilcrow"></a>
Table of Contents
  </h2>
</div>
<details><summary>Click to expand</summary>
<ul>
<li><a href="#background.html">Background</a></li>
<li><a href="#example.html">Example</a></li>
<li><a href="#browser-support.html">Browser Support</a></li>
<li><a href="#public-api-for-consumers.html">Public API For Consumers</a></li>
<li><a href="#private-api-for-implementors.html">Private API For Implementors</a></li>
<li><a href="#test-suite.html">Test Suite</a></li>
<li><a href="#spread-the-word.html">Spread The Word</a></li>
<li><a href="#install.html">Install</a></li>
<li><a href="#contributing.html">Contributing</a></li>
<li><a href="#big-thanks.html">Big Thanks</a></li>
<li><a href="#donate.html">Donate</a></li>
<li><a href="#license.html">License</a></li>
</ul>
</details>
<div class="pilwrap" id="background">
  <h2>
    <a href="#background" name="background" class="pilcrow"></a>
Background
  </h2>
</div>
<p>This module provides a simple base prototype for a key-value store. It has a public API for consumers and a private API for implementors. To implement a <code>abstract-leveldown</code> compliant store, extend its prototype and override the private underscore versions of the methods. For example, to implement <code>put()</code>, override <code>_put()</code> on your prototype.</p>
<p>Where possible, the default private methods have sensible <em>noop</em> defaults that essentially do nothing. For example, <code>_open(callback)</code> will invoke <code>callback</code> on a next tick. Other methods like <code>_clear(..)</code> have functional defaults. Each method listed below documents whether implementing it is mandatory.</p>
<p>The private methods are always provided with consistent arguments, regardless of what is passed in through the public API. All public methods provide argument checking: if a consumer calls <code>open()</code> without a callback argument they'll get an <code>Error('open() requires a callback argument')</code>.</p>
<p>Where optional arguments are involved, private methods receive sensible defaults: a <code>get(key, callback)</code> call translates to <code>_get(key, options, callback)</code> where the <code>options</code> argument is an empty object. These arguments are documented below.</p>
<p><strong>If you are upgrading:</strong> please see <a href="UPGRADING.md.html">UPGRADING.md</a>.</p>
<div class="pilwrap" id="example">
  <h2>
    <a href="#example" name="example" class="pilcrow"></a>
Example
  </h2>
</div>
<p>Let's implement a simplistic in-memory <a href="https://github.com/Level/leveldown"><code>leveldown</code></a> replacement:</p>
<pre><code class="js"><span class="hljs-keyword">var</span> AbstractLevelDOWN = <span class="hljs-built_in">require</span>(<span class="hljs-string">'abstract-leveldown'</span>).AbstractLevelDOWN
<span class="hljs-keyword">var</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>)

<span class="hljs-comment">// Constructor</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FakeLevelDOWN</span> (<span class="hljs-params"></span>) </span>{
  AbstractLevelDOWN.call(<span class="hljs-keyword">this</span>)
}

<span class="hljs-comment">// Our new prototype inherits from AbstractLevelDOWN</span>
util.inherits(FakeLevelDOWN, AbstractLevelDOWN)

FakeLevelDOWN.prototype._open = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">options, callback</span>) </span>{
  <span class="hljs-comment">// Initialize a memory storage object</span>
  <span class="hljs-keyword">this</span>._store = {}

  <span class="hljs-comment">// Use nextTick to be a nice async citizen</span>
  process.nextTick(callback)
}

FakeLevelDOWN.prototype._serializeKey = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{
  <span class="hljs-comment">// As an example, prefix all input keys with an exclamation mark.</span>
  <span class="hljs-comment">// Below methods will receive serialized keys in their arguments.</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">'!'</span> + key
}

FakeLevelDOWN.prototype._put = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key, value, options, callback</span>) </span>{
  <span class="hljs-keyword">this</span>._store[key] = value
  process.nextTick(callback)
}

FakeLevelDOWN.prototype._get = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key, options, callback</span>) </span>{
  <span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>._store[key]

  <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">undefined</span>) {
    <span class="hljs-comment">// 'NotFound' error, consistent with LevelDOWN API</span>
    <span class="hljs-keyword">return</span> process.nextTick(callback, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'NotFound'</span>))
  }

  process.nextTick(callback, <span class="hljs-literal">null</span>, value)
}

FakeLevelDOWN.prototype._del = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key, options, callback</span>) </span>{
  <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._store[key]
  process.nextTick(callback)
}
</code></pre>
<p>Now we can use our implementation with <code>levelup</code>:</p>
<pre><code class="js"><span class="hljs-keyword">var</span> levelup = <span class="hljs-built_in">require</span>(<span class="hljs-string">'levelup'</span>)

<span class="hljs-keyword">var</span> db = levelup(<span class="hljs-keyword">new</span> FakeLevelDOWN())

db.put(<span class="hljs-string">'foo'</span>, <span class="hljs-string">'bar'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err

  db.get(<span class="hljs-string">'foo'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, value</span>) </span>{
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err

    <span class="hljs-built_in">console</span>.log(value) <span class="hljs-comment">// 'bar'</span>
  })
})
</code></pre>
<p>See <a href="https://github.com/Level/memdown/"><code>memdown</code></a> if you are looking for a complete in-memory replacement for <code>leveldown</code>.</p>
<div class="pilwrap" id="browser-support">
  <h2>
    <a href="#browser-support" name="browser-support" class="pilcrow"></a>
Browser Support
  </h2>
</div>
<p><a href="https://saucelabs.com/u/abstract-leveldown"><img src="https://saucelabs.com/browser-matrix/abstract-leveldown.svg" alt="Sauce Test Status"></a></p>
<div class="pilwrap" id="public-api-for-consumers">
  <h2>
    <a href="#public-api-for-consumers" name="public-api-for-consumers" class="pilcrow"></a>
Public API For Consumers
  </h2>
</div>
<div class="pilwrap" id="db-constructor..">
  <h3>
    <a href="#db-constructor.." name="db-constructor.." class="pilcrow"></a>
<code>db = constructor(..)</code>
  </h3>
</div>
<p>Constructors typically take a <code>location</code> argument pointing to a location on disk where the data will be stored. Since not all implementations are disk-based and some are non-persistent, implementors are free to take zero or more arguments in their constructor.</p>
<div class="pilwrap" id="db.status">
  <h3>
    <a href="#db.status" name="db.status" class="pilcrow"></a>
<code>db.status</code>
  </h3>
</div>
<p>A read-only property. An <code>abstract-leveldown</code> compliant store can be in one of the following states:</p>
<ul>
<li><code>'new'</code> - newly created, not opened or closed</li>
<li><code>'opening'</code> - waiting for the store to be opened</li>
<li><code>'open'</code> - successfully opened the store, available for use</li>
<li><code>'closing'</code> - waiting for the store to be closed</li>
<li><code>'closed'</code> - store has been successfully closed, should not be used.</li>
</ul>
<div class="pilwrap" id="db.supports">
  <h3>
    <a href="#db.supports" name="db.supports" class="pilcrow"></a>
<code>db.supports</code>
  </h3>
</div>
<p>A read-only <a href="https://github.com/Level/supports">manifest</a>. Might be used like so:</p>
<pre><code class="js"><span class="hljs-keyword">if</span> (!db.supports.permanence) {
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Persistent storage is required'</span>)
}

<span class="hljs-keyword">if</span> (db.supports.bufferKeys &amp;&amp; db.supports.promises) {
  <span class="hljs-keyword">await</span> db.put(Buffer.from(<span class="hljs-string">'key'</span>), <span class="hljs-string">'value'</span>)
}
</code></pre>
<div class="pilwrap" id="db.open-options-callback">
  <h3>
    <a href="#db.open-options-callback" name="db.open-options-callback" class="pilcrow"></a>
<code>db.open([options, ]callback)</code>
  </h3>
</div>
<p>Open the store. The <code>callback</code> function will be called with no arguments when the store has been successfully opened, or with a single error argument if the open operation failed for any reason.</p>
<p>The optional <code>options</code> argument may contain:</p>
<ul>
<li><code>createIfMissing</code> <em>(boolean, default: <code>true</code>)</em>: If <code>true</code> and the store doesn't exist it will be created. If <code>false</code> and the store doesn't exist, <code>callback</code> will receive an error.</li>
<li><code>errorIfExists</code> <em>(boolean, default: <code>false</code>)</em>: If <code>true</code> and the store exists, <code>callback</code> will receive an error.</li>
</ul>
<p>Not all implementations support the above options.</p>
<div class="pilwrap" id="db.close-callback">
  <h3>
    <a href="#db.close-callback" name="db.close-callback" class="pilcrow"></a>
<code>db.close(callback)</code>
  </h3>
</div>
<p>Close the store. The <code>callback</code> function will be called with no arguments if the operation is successful or with a single <code>error</code> argument if closing failed for any reason.</p>
<div class="pilwrap" id="db.get-key-options-callback">
  <h3>
    <a href="#db.get-key-options-callback" name="db.get-key-options-callback" class="pilcrow"></a>
<code>db.get(key[, options], callback)</code>
  </h3>
</div>
<p>Get a value from the store by <code>key</code>. The optional <code>options</code> object may contain:</p>
<ul>
<li><code>asBuffer</code> <em>(boolean, default: <code>true</code>)</em>: Whether to return the <code>value</code> as a Buffer. If <code>false</code>, the returned type depends on the implementation.</li>
</ul>
<p>The <code>callback</code> function will be called with an <code>Error</code> if the operation failed for any reason. If successful the first argument will be <code>null</code> and the second argument will be the value.</p>
<div class="pilwrap" id="db.put-key-value-options-callback">
  <h3>
    <a href="#db.put-key-value-options-callback" name="db.put-key-value-options-callback" class="pilcrow"></a>
<code>db.put(key, value[, options], callback)</code>
  </h3>
</div>
<p>Store a new entry or overwrite an existing entry. There are no <code>options</code> by default but implementations may add theirs. The <code>callback</code> function will be called with no arguments if the operation is successful or with an <code>Error</code> if putting failed for any reason.</p>
<div class="pilwrap" id="db.del-key-options-callback">
  <h3>
    <a href="#db.del-key-options-callback" name="db.del-key-options-callback" class="pilcrow"></a>
<code>db.del(key[, options], callback)</code>
  </h3>
</div>
<p>Delete an entry. There are no <code>options</code> by default but implementations may add theirs. The <code>callback</code> function will be called with no arguments if the operation is successful or with an <code>Error</code> if deletion failed for any reason.</p>
<div class="pilwrap" id="db.batch-operations-options-callback">
  <h3>
    <a href="#db.batch-operations-options-callback" name="db.batch-operations-options-callback" class="pilcrow"></a>
<code>db.batch(operations[, options], callback)</code>
  </h3>
</div>
<p>Perform multiple <em>put</em> and/or <em>del</em> operations in bulk. The <code>operations</code> argument must be an <code>Array</code> containing a list of operations to be executed sequentially, although as a whole they are performed as an atomic operation.</p>
<p>Each operation is contained in an object having the following properties: <code>type</code>, <code>key</code>, <code>value</code>, where the <code>type</code> is either <code>'put'</code> or <code>'del'</code>. In the case of <code>'del'</code> the <code>value</code> property is ignored.</p>
<p>There are no <code>options</code> by default but implementations may add theirs. The <code>callback</code> function will be called with no arguments if the batch is successful or with an <code>Error</code> if the batch failed for any reason.</p>
<div class="pilwrap" id="db.batch">
  <h3>
    <a href="#db.batch" name="db.batch" class="pilcrow"></a>
<code>db.batch()</code>
  </h3>
</div>
<p>Returns a <a href="#chainedbatch.html"><code>chainedBatch</code></a>.</p>
<div class="pilwrap" id="db.iterator-options">
  <h3>
    <a href="#db.iterator-options" name="db.iterator-options" class="pilcrow"></a>
<code>db.iterator([options])</code>
  </h3>
</div>
<p>Returns an <a href="#iterator.html"><code>iterator</code></a>. Accepts the following range options:</p>
<ul>
<li><code>gt</code> (greater than), <code>gte</code> (greater than or equal) define the lower bound of the range to be iterated. Only entries where the key is greater than (or equal to) this option will be included in the range. When <code>reverse=true</code> the order will be reversed, but the entries iterated will be the same.</li>
<li><code>lt</code> (less than), <code>lte</code> (less than or equal) define the higher bound of the range to be iterated. Only entries where the key is less than (or equal to) this option will be included in the range. When <code>reverse=true</code> the order will be reversed, but the entries iterated will be the same.</li>
<li><code>reverse</code> <em>(boolean, default: <code>false</code>)</em>: iterate entries in reverse order. Beware that a reverse seek can be slower than a forward seek.</li>
<li><code>limit</code> <em>(number, default: <code>-1</code>)</em>: limit the number of entries collected by this iterator. This number represents a <em>maximum</em> number of entries and may not be reached if you get to the end of the range first. A value of <code>-1</code> means there is no limit. When <code>reverse=true</code> the entries with the highest keys will be returned instead of the lowest keys.</li>
</ul>
<p>Legacy options:</p>
<ul>
<li><code>start</code>: instead use <code>gte</code></li>
<li><code>end</code>: instead use <code>lte</code>.</li>
</ul>
<p><strong>Note</strong> Zero-length strings, buffers and arrays as well as <code>null</code> and <code>undefined</code> are invalid as keys, yet valid as range options. These types are significant in encodings like <a href="https://github.com/deanlandolt/bytewise"><code>bytewise</code></a> and <a href="https://github.com/dominictarr/charwise"><code>charwise</code></a> as well as some underlying stores like IndexedDB. Consumers of an implementation should assume that <code>{ gt: undefined }</code> is <em>not</em> the same as <code>{}</code>. An implementation can choose to:</p>
<ul>
<li><a href="#db_serializekeykey.html"><em>Serialize</em></a> or <a href="https://github.com/Level/encoding-down"><em>encode</em></a> these types to make them meaningful</li>
<li>Have no defined behavior (moving the concern to a higher level)</li>
<li>Delegate to an underlying store (moving the concern to a lower level).</li>
</ul>
<p>If you are an implementor, a final note: the <a href="#test-suite.html">abstract test suite</a> does not test these types. Whether they are supported or how they sort is up to you; add custom tests accordingly.</p>
<p>In addition to range options, <code>iterator()</code> takes the following options:</p>
<ul>
<li><code>keys</code> <em>(boolean, default: <code>true</code>)</em>: whether to return the key of each entry. If set to <code>false</code>, calls to <code>iterator.next(callback)</code> will yield keys with a value of <code>undefined</code>.</li>
<li><code>values</code> <em>(boolean, default: <code>true</code>)</em>: whether to return the value of each entry. If set to <code>false</code>, calls to <code>iterator.next(callback)</code> will yield values with a value of <code>undefined</code>.</li>
<li><code>keyAsBuffer</code> <em>(boolean, default: <code>true</code>)</em>: Whether to return the key of each entry as a Buffer. If <code>false</code>, the returned type depends on the implementation.</li>
<li><code>valueAsBuffer</code> <em>(boolean, default: <code>true</code>)</em>: Whether to return the value of each entry as a Buffer.</li>
</ul>
<p>Lastly, an implementation is free to add its own options.</p>
<div class="pilwrap" id="db.clear-options-callback">
  <h3>
    <a href="#db.clear-options-callback" name="db.clear-options-callback" class="pilcrow"></a>
<code>db.clear([options, ]callback)</code>
  </h3>
</div>
<p><strong>This method is experimental. Not all implementations support it yet.</strong></p>
<p>Delete all entries or a range. Not guaranteed to be atomic. Accepts the following range options (with the same rules as on iterators):</p>
<ul>
<li><code>gt</code> (greater than), <code>gte</code> (greater than or equal) define the lower bound of the range to be deleted. Only entries where the key is greater than (or equal to) this option will be included in the range. When <code>reverse=true</code> the order will be reversed, but the entries deleted will be the same.</li>
<li><code>lt</code> (less than), <code>lte</code> (less than or equal) define the higher bound of the range to be deleted. Only entries where the key is less than (or equal to) this option will be included in the range. When <code>reverse=true</code> the order will be reversed, but the entries deleted will be the same.</li>
<li><code>reverse</code> <em>(boolean, default: <code>false</code>)</em>: delete entries in reverse order. Only effective in combination with <code>limit</code>, to remove the last N records.</li>
<li><code>limit</code> <em>(number, default: <code>-1</code>)</em>: limit the number of entries to be deleted. This number represents a <em>maximum</em> number of entries and may not be reached if you get to the end of the range first. A value of <code>-1</code> means there is no limit. When <code>reverse=true</code> the entries with the highest keys will be deleted instead of the lowest keys.</li>
</ul>
<p>If no options are provided, all entries will be deleted. The <code>callback</code> function will be called with no arguments if the operation was successful or with an <code>Error</code> if it failed for any reason.</p>
<div class="pilwrap" id="chainedbatch">
  <h3>
    <a href="#chainedbatch" name="chainedbatch" class="pilcrow"></a>
<code>chainedBatch</code>
  </h3>
</div>
<div class="pilwrap" id="chainedbatch.put-key-value">
  <h4>
    <a href="#chainedbatch.put-key-value" name="chainedbatch.put-key-value" class="pilcrow"></a>
<code>chainedBatch.put(key, value)</code>
  </h4>
</div>
<p>Queue a <code>put</code> operation on this batch. This may throw if <code>key</code> or <code>value</code> is invalid.</p>
<div class="pilwrap" id="chainedbatch.del-key">
  <h4>
    <a href="#chainedbatch.del-key" name="chainedbatch.del-key" class="pilcrow"></a>
<code>chainedBatch.del(key)</code>
  </h4>
</div>
<p>Queue a <code>del</code> operation on this batch. This may throw if <code>key</code> is invalid.</p>
<div class="pilwrap" id="chainedbatch.clear">
  <h4>
    <a href="#chainedbatch.clear" name="chainedbatch.clear" class="pilcrow"></a>
<code>chainedBatch.clear()</code>
  </h4>
</div>
<p>Clear all queued operations on this batch.</p>
<div class="pilwrap" id="chainedbatch.write-options-callback">
  <h4>
    <a href="#chainedbatch.write-options-callback" name="chainedbatch.write-options-callback" class="pilcrow"></a>
<code>chainedBatch.write([options, ]callback)</code>
  </h4>
</div>
<p>Commit the queued operations for this batch. All operations will be written atomically, that is, they will either all succeed or fail with no partial commits.</p>
<p>There are no <code>options</code> by default but implementations may add theirs. The <code>callback</code> function will be called with no arguments if the batch is successful or with an <code>Error</code> if the batch failed for any reason.</p>
<p>After <code>write</code> has been called, no further operations are allowed.</p>
<div class="pilwrap" id="chainedbatch.db">
  <h4>
    <a href="#chainedbatch.db" name="chainedbatch.db" class="pilcrow"></a>
<code>chainedBatch.db</code>
  </h4>
</div>
<p>A reference to the <code>db</code> that created this chained batch.</p>
<div class="pilwrap" id="iterator">
  <h3>
    <a href="#iterator" name="iterator" class="pilcrow"></a>
<code>iterator</code>
  </h3>
</div>
<p>An iterator allows you to <em>iterate</em> the entire store or a range. It operates on a snapshot of the store, created at the time <code>db.iterator()</code> was called. This means reads on the iterator are unaffected by simultaneous writes. Most but not all implementations can offer this guarantee.</p>
<p>An iterator keeps track of when a <code>next()</code> is in progress and when an <code>end()</code> has been called so it doesn't allow concurrent <code>next()</code> calls, it does allow <code>end()</code> while a <code>next()</code> is in progress and it doesn't allow either <code>next()</code> or <code>end()</code> after <code>end()</code> has been called.</p>
<div class="pilwrap" id="iterator.next-callback">
  <h4>
    <a href="#iterator.next-callback" name="iterator.next-callback" class="pilcrow"></a>
<code>iterator.next(callback)</code>
  </h4>
</div>
<p>Advance the iterator and yield the entry at that key. If an error occurs, the <code>callback</code> function will be called with an <code>Error</code>. Otherwise, the <code>callback</code> receives <code>null</code>, a <code>key</code> and a <code>value</code>. The type of <code>key</code> and <code>value</code> depends on the options passed to <code>db.iterator()</code>.</p>
<p>If the iterator has reached its end, both <code>key</code> and <code>value</code> will be <code>undefined</code>. This happens in the following situations:</p>
<ul>
<li>The end of the store has been reached</li>
<li>The end of the range has been reached</li>
<li>The last <code>iterator.seek()</code> was out of range.</li>
</ul>
<p><strong>Note:</strong> Don't forget to call <code>iterator.end()</code>, even if you received an error.</p>
<div class="pilwrap" id="iterator.seek-target">
  <h4>
    <a href="#iterator.seek-target" name="iterator.seek-target" class="pilcrow"></a>
<code>iterator.seek(target)</code>
  </h4>
</div>
<p>Seek the iterator to a given key or the closest key. Subsequent calls to <code>iterator.next()</code> will yield entries with keys equal to or larger than <code>target</code>, or equal to or smaller than <code>target</code> if the <code>reverse</code> option passed to <code>db.iterator()</code> was true.</p>
<p>If range options like <code>gt</code> were passed to <code>db.iterator()</code> and <code>target</code> does not fall within that range, the iterator will reach its end.</p>
<p><strong>Note:</strong> At the time of writing, <a href="https://github.com/Level/leveldown"><code>leveldown</code></a> is the only known implementation to support <code>seek()</code>. In other implementations, it is a noop.</p>
<div class="pilwrap" id="iterator.end-callback">
  <h4>
    <a href="#iterator.end-callback" name="iterator.end-callback" class="pilcrow"></a>
<code>iterator.end(callback)</code>
  </h4>
</div>
<p>End iteration and free up underlying resources. The <code>callback</code> function will be called with no arguments on success or with an <code>Error</code> if ending failed for any reason.</p>
<div class="pilwrap" id="iterator.db">
  <h4>
    <a href="#iterator.db" name="iterator.db" class="pilcrow"></a>
<code>iterator.db</code>
  </h4>
</div>
<p>A reference to the <code>db</code> that created this iterator.</p>
<div class="pilwrap" id="type-support">
  <h3>
    <a href="#type-support" name="type-support" class="pilcrow"></a>
Type Support
  </h3>
</div>
<p>The following applies to any method above that takes a <code>key</code> argument or option: all implementations <em>must</em> support a <code>key</code> of type String and <em>should</em> support a <code>key</code> of type Buffer. A <code>key</code> may not be <code>null</code>, <code>undefined</code>, a zero-length Buffer, zero-length string or zero-length array.</p>
<p>The following applies to any method above that takes a <code>value</code> argument or option: all implementations <em>must</em> support a <code>value</code> of type String or Buffer. A <code>value</code> may not be <code>null</code> or <code>undefined</code> due to preexisting significance in streams and iterators.</p>
<p>Support of other key and value types depends on the implementation as well as its underlying storage. See also <a href="#db_serializekeykey.html"><code>db._serializeKey</code></a> and <a href="#db_serializevaluevalue.html"><code>db._serializeValue</code></a>.</p>
<div class="pilwrap" id="private-api-for-implementors">
  <h2>
    <a href="#private-api-for-implementors" name="private-api-for-implementors" class="pilcrow"></a>
Private API For Implementors
  </h2>
</div>
<p>Each of these methods will receive exactly the number and order of arguments described. Optional arguments will receive sensible defaults. All callbacks are error-first and must be asynchronous.</p>
<p>If an operation within your implementation is synchronous, be sure to invoke the callback on a next tick using <code>process.nextTick</code> or some other means of microtask scheduling. For convenience, the prototypes of <code>AbstractLevelDOWN</code>, <code>AbstractIterator</code> and <code>AbstractChainedBatch</code> include a <code>_nextTick</code> method that is compatible with node and browsers.</p>
<div class="pilwrap" id="db-abstractleveldown-manifest">
  <h3>
    <a href="#db-abstractleveldown-manifest" name="db-abstractleveldown-manifest" class="pilcrow"></a>
<code>db = AbstractLevelDOWN([manifest])</code>
  </h3>
</div>
<p>The constructor. Sets the <code>.status</code> to <code>'new'</code>. Optionally takes a <a href="https://github.com/Level/supports">manifest</a> object which <code>abstract-leveldown</code> will enrich:</p>
<pre><code class="js">AbstractLevelDOWN.call(<span class="hljs-keyword">this</span>, {
  <span class="hljs-attr">bufferKeys</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">snapshots</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-comment">// ..</span>
})
</code></pre>
<div class="pilwrap" id="db._open-options-callback">
  <h3>
    <a href="#db._open-options-callback" name="db._open-options-callback" class="pilcrow"></a>
<code>db._open(options, callback)</code>
  </h3>
</div>
<p>Open the store. The <code>options</code> object will always have the following properties: <code>createIfMissing</code>, <code>errorIfExists</code>. If opening failed, call the <code>callback</code> function with an <code>Error</code>. Otherwise call <code>callback</code> without any arguments.</p>
<p>The default <code>_open()</code> is a sensible noop and invokes <code>callback</code> on a next tick.</p>
<div class="pilwrap" id="db._close-callback">
  <h3>
    <a href="#db._close-callback" name="db._close-callback" class="pilcrow"></a>
<code>db._close(callback)</code>
  </h3>
</div>
<p>Close the store. If closing failed, call the <code>callback</code> function with an <code>Error</code>. Otherwise call <code>callback</code> without any arguments.</p>
<p>The default <code>_close()</code> is a sensible noop and invokes <code>callback</code> on a next tick.</p>
<div class="pilwrap" id="db._serializekey-key">
  <h3>
    <a href="#db._serializekey-key" name="db._serializekey-key" class="pilcrow"></a>
<code>db._serializeKey(key)</code>
  </h3>
</div>
<p>Convert a <code>key</code> to a type supported by the underlying storage. All methods below that take a <code>key</code> argument or option - including <code>db._iterator()</code> with its range options and <code>iterator._seek()</code> with its <code>target</code> argument - will receive serialized keys. For example, if <code>_serializeKey</code> is implemented as:</p>
<pre><code class="js">FakeLevelDOWN.prototype._serializeKey = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{
  <span class="hljs-keyword">return</span> Buffer.isBuffer(key) ? key : <span class="hljs-built_in">String</span>(key)
}
</code></pre>
<p>Then <code>db.get(2, callback)</code> translates into <code>db._get('2', options, callback)</code>. Similarly, <code>db.iterator({ gt: 2 })</code> translates into <code>db._iterator({ gt: '2', ... })</code> and <code>iterator.seek(2)</code> translates into <code>iterator._seek('2')</code>.</p>
<p>If the underlying storage supports any JavaScript type or if your implementation wraps another implementation, it is recommended to make <code>_serializeKey</code> an identity function (returning the key as-is). Serialization is irreversible, unlike <em>encoding</em> as performed by implementations like <a href="https://github.com/Level/encoding-down"><code>encoding-down</code></a>. This also applies to <code>_serializeValue</code>.</p>
<p>The default <code>_serializeKey()</code> is an identity function.</p>
<div class="pilwrap" id="db._serializevalue-value">
  <h3>
    <a href="#db._serializevalue-value" name="db._serializevalue-value" class="pilcrow"></a>
<code>db._serializeValue(value)</code>
  </h3>
</div>
<p>Convert a <code>value</code> to a type supported by the underlying storage. All methods below that take a <code>value</code> argument or option will receive serialized values. For example, if <code>_serializeValue</code> is implemented as:</p>
<pre><code class="js">FakeLevelDOWN.prototype._serializeValue = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>{
  <span class="hljs-keyword">return</span> Buffer.isBuffer(value) ? value : <span class="hljs-built_in">String</span>(value)
}
</code></pre>
<p>Then <code>db.put(key, 2, callback)</code> translates into <code>db._put(key, '2', options, callback)</code>.</p>
<p>The default <code>_serializeValue()</code> is an identity function.</p>
<div class="pilwrap" id="db._get-key-options-callback">
  <h3>
    <a href="#db._get-key-options-callback" name="db._get-key-options-callback" class="pilcrow"></a>
<code>db._get(key, options, callback)</code>
  </h3>
</div>
<p>Get a value by <code>key</code>. The <code>options</code> object will always have the following properties: <code>asBuffer</code>. If the key does not exist, call the <code>callback</code> function with a <code>new Error('NotFound')</code>. Otherwise call <code>callback</code> with <code>null</code> as the first argument and the value as the second.</p>
<p>The default <code>_get()</code> invokes <code>callback</code> on a next tick with a <code>NotFound</code> error. It must be overridden.</p>
<div class="pilwrap" id="db._put-key-value-options-callback">
  <h3>
    <a href="#db._put-key-value-options-callback" name="db._put-key-value-options-callback" class="pilcrow"></a>
<code>db._put(key, value, options, callback)</code>
  </h3>
</div>
<p>Store a new entry or overwrite an existing entry. There are no default options but <code>options</code> will always be an object. If putting failed, call the <code>callback</code> function with an <code>Error</code>. Otherwise call <code>callback</code> without any arguments.</p>
<p>The default <code>_put()</code> invokes <code>callback</code> on a next tick. It must be overridden.</p>
<div class="pilwrap" id="db._del-key-options-callback">
  <h3>
    <a href="#db._del-key-options-callback" name="db._del-key-options-callback" class="pilcrow"></a>
<code>db._del(key, options, callback)</code>
  </h3>
</div>
<p>Delete an entry. There are no default options but <code>options</code> will always be an object. If deletion failed, call the <code>callback</code> function with an <code>Error</code>. Otherwise call <code>callback</code> without any arguments.</p>
<p>The default <code>_del()</code> invokes <code>callback</code> on a next tick. It must be overridden.</p>
<div class="pilwrap" id="db._batch-operations-options-callback">
  <h3>
    <a href="#db._batch-operations-options-callback" name="db._batch-operations-options-callback" class="pilcrow"></a>
<code>db._batch(operations, options, callback)</code>
  </h3>
</div>
<p>Perform multiple <em>put</em> and/or <em>del</em> operations in bulk. The <code>operations</code> argument is always an <code>Array</code> containing a list of operations to be executed sequentially, although as a whole they should be performed as an atomic operation. Each operation is guaranteed to have at least <code>type</code> and <code>key</code> properties. There are no default options but <code>options</code> will always be an object. If the batch failed, call the <code>callback</code> function with an <code>Error</code>. Otherwise call <code>callback</code> without any arguments.</p>
<p>The default <code>_batch()</code> invokes <code>callback</code> on a next tick. It must be overridden.</p>
<div class="pilwrap" id="db._chainedbatch">
  <h3>
    <a href="#db._chainedbatch" name="db._chainedbatch" class="pilcrow"></a>
<code>db._chainedBatch()</code>
  </h3>
</div>
<p>The default <code>_chainedBatch()</code> returns a functional <code>AbstractChainedBatch</code> instance that uses <code>db._batch(array, options, callback)</code> under the hood. The prototype is available on the main exports for you to extend. If you want to implement chainable batch operations in a different manner then you should extend <code>AbstractChainedBatch</code> and return an instance of this prototype in the <code>_chainedBatch()</code> method:</p>
<pre><code class="js"><span class="hljs-keyword">var</span> AbstractChainedBatch = <span class="hljs-built_in">require</span>(<span class="hljs-string">'abstract-leveldown'</span>).AbstractChainedBatch
<span class="hljs-keyword">var</span> inherits = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>).inherits

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ChainedBatch</span> (<span class="hljs-params">db</span>) </span>{
  AbstractChainedBatch.call(<span class="hljs-keyword">this</span>, db)
}

inherits(ChainedBatch, AbstractChainedBatch)

FakeLevelDOWN.prototype._chainedBatch = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ChainedBatch(<span class="hljs-keyword">this</span>)
}
</code></pre>
<div class="pilwrap" id="db._iterator-options">
  <h3>
    <a href="#db._iterator-options" name="db._iterator-options" class="pilcrow"></a>
<code>db._iterator(options)</code>
  </h3>
</div>
<p>The default <code>_iterator()</code> returns a noop <code>AbstractIterator</code> instance. It must be overridden, by extending <code>AbstractIterator</code> (available on the main module exports) and returning an instance of this prototype in the <code>_iterator(options)</code> method.</p>
<p>The <code>options</code> object will always have the following properties: <code>reverse</code>, <code>keys</code>, <code>values</code>, <code>limit</code>, <code>keyAsBuffer</code> and <code>valueAsBuffer</code>.</p>
<div class="pilwrap" id="db._clear-options-callback">
  <h3>
    <a href="#db._clear-options-callback" name="db._clear-options-callback" class="pilcrow"></a>
<code>db._clear(options, callback)</code>
  </h3>
</div>
<p><strong>This method is experimental and optional for the time being. To enable its tests, set the <a href="#excluding-tests.html"><code>clear</code> option of the test suite</a> to <code>true</code>.</strong></p>
<p>Delete all entries or a range. Does not have to be atomic. It is recommended (and possibly mandatory in the future) to operate on a snapshot so that writes scheduled after a call to <code>clear()</code> will not be affected.</p>
<p>The default <code>_clear()</code> uses <code>_iterator()</code> and <code>_del()</code> to provide a reasonable fallback, but requires binary key support. It is <em>recommended</em> to implement <code>_clear()</code> with more performant primitives than <code>_iterator()</code> and <code>_del()</code> if the underlying storage has such primitives. Implementations that don't support binary keys <em>must</em> implement their own <code>_clear()</code>.</p>
<p>Implementations that wrap another <code>db</code> can typically forward the <code>_clear()</code> call to that <code>db</code>, having transformed range options if necessary.</p>
<p>The <code>options</code> object will always have the following properties: <code>reverse</code> and <code>limit</code>.</p>
<div class="pilwrap" id="iterator-abstractiterator-db">
  <h3>
    <a href="#iterator-abstractiterator-db" name="iterator-abstractiterator-db" class="pilcrow"></a>
<code>iterator = AbstractIterator(db)</code>
  </h3>
</div>
<p>The first argument to this constructor must be an instance of your <code>AbstractLevelDOWN</code> implementation. The constructor will set <code>iterator.db</code> which is used to access <code>db._serialize*</code> and ensures that <code>db</code> will not be garbage collected in case there are no other references to it.</p>
<div class="pilwrap" id="iterator._next-callback">
  <h4>
    <a href="#iterator._next-callback" name="iterator._next-callback" class="pilcrow"></a>
<code>iterator._next(callback)</code>
  </h4>
</div>
<p>Advance the iterator and yield the entry at that key. If nexting failed, call the <code>callback</code> function with an <code>Error</code>. Otherwise, call <code>callback</code> with <code>null</code>, a <code>key</code> and a <code>value</code>.</p>
<p>The default <code>_next()</code> invokes <code>callback</code> on a next tick. It must be overridden.</p>
<div class="pilwrap" id="iterator._seek-target">
  <h4>
    <a href="#iterator._seek-target" name="iterator._seek-target" class="pilcrow"></a>
<code>iterator._seek(target)</code>
  </h4>
</div>
<p>Seek the iterator to a given key or the closest key. This method is optional.</p>
<div class="pilwrap" id="iterator._end-callback">
  <h4>
    <a href="#iterator._end-callback" name="iterator._end-callback" class="pilcrow"></a>
<code>iterator._end(callback)</code>
  </h4>
</div>
<p>Free up underlying resources. This method is guaranteed to only be called once. If ending failed, call the <code>callback</code> function with an <code>Error</code>. Otherwise call <code>callback</code> without any arguments.</p>
<p>The default <code>_end()</code> invokes <code>callback</code> on a next tick. Overriding is optional.</p>
<div class="pilwrap" id="chainedbatch-abstractchainedbatch-db">
  <h3>
    <a href="#chainedbatch-abstractchainedbatch-db" name="chainedbatch-abstractchainedbatch-db" class="pilcrow"></a>
<code>chainedBatch = AbstractChainedBatch(db)</code>
  </h3>
</div>
<p>The first argument to this constructor must be an instance of your <code>AbstractLevelDOWN</code> implementation. The constructor will set <code>chainedBatch.db</code> which is used to access <code>db._serialize*</code> and ensures that <code>db</code> will not be garbage collected in case there are no other references to it.</p>
<div class="pilwrap" id="chainedbatch._put-key-value">
  <h4>
    <a href="#chainedbatch._put-key-value" name="chainedbatch._put-key-value" class="pilcrow"></a>
<code>chainedBatch._put(key, value)</code>
  </h4>
</div>
<p>Queue a <code>put</code> operation on this batch.</p>
<div class="pilwrap" id="chainedbatch._del-key">
  <h4>
    <a href="#chainedbatch._del-key" name="chainedbatch._del-key" class="pilcrow"></a>
<code>chainedBatch._del(key)</code>
  </h4>
</div>
<p>Queue a <code>del</code> operation on this batch.</p>
<div class="pilwrap" id="chainedbatch._clear">
  <h4>
    <a href="#chainedbatch._clear" name="chainedbatch._clear" class="pilcrow"></a>
<code>chainedBatch._clear()</code>
  </h4>
</div>
<p>Clear all queued operations on this batch.</p>
<div class="pilwrap" id="chainedbatch._write-options-callback">
  <h4>
    <a href="#chainedbatch._write-options-callback" name="chainedbatch._write-options-callback" class="pilcrow"></a>
<code>chainedBatch._write(options, callback)</code>
  </h4>
</div>
<p>The default <code>_write</code> method uses <code>db._batch</code>. If the <code>_write</code> method is overridden it must atomically commit the queued operations. There are no default options but <code>options</code> will always be an object. If committing fails, call the <code>callback</code> function with an <code>Error</code>. Otherwise call <code>callback</code> without any arguments.</p>
<div class="pilwrap" id="test-suite">
  <h2>
    <a href="#test-suite" name="test-suite" class="pilcrow"></a>
Test Suite
  </h2>
</div>
<p>To prove that your implementation is <code>abstract-leveldown</code> compliant, include the abstract test suite in your <code>test.js</code> (or similar):</p>
<pre><code class="js"><span class="hljs-keyword">const</span> test = <span class="hljs-built_in">require</span>(<span class="hljs-string">'tape'</span>)
<span class="hljs-keyword">const</span> suite = <span class="hljs-built_in">require</span>(<span class="hljs-string">'abstract-leveldown/test'</span>)
<span class="hljs-keyword">const</span> YourDOWN = <span class="hljs-built_in">require</span>(<span class="hljs-string">'.'</span>)

suite({
  <span class="hljs-attr">test</span>: test,
  <span class="hljs-attr">factory</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> YourDOWN()
  }
})
</code></pre>
<p>This is the most minimal setup. The <code>test</code> option <em>must</em> be a function that is API-compatible with <code>tape</code>. The <code>factory</code> option <em>must</em> be a function that returns a unique and isolated database instance. The factory will be called many times by the test suite.</p>
<p>If your implementation is disk-based we recommend using <a href="https://github.com/sindresorhus/tempy"><code>tempy</code></a> (or similar) to create unique temporary directories. Your setup could look something like:</p>
<pre><code class="js"><span class="hljs-keyword">const</span> test = <span class="hljs-built_in">require</span>(<span class="hljs-string">'tape'</span>)
<span class="hljs-keyword">const</span> tempy = <span class="hljs-built_in">require</span>(<span class="hljs-string">'tempy'</span>)
<span class="hljs-keyword">const</span> suite = <span class="hljs-built_in">require</span>(<span class="hljs-string">'abstract-leveldown/test'</span>)
<span class="hljs-keyword">const</span> YourDOWN = <span class="hljs-built_in">require</span>(<span class="hljs-string">'.'</span>)

suite({
  <span class="hljs-attr">test</span>: test,
  <span class="hljs-attr">factory</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> YourDOWN(tempy.directory())
  }
})
</code></pre>
<div class="pilwrap" id="excluding-tests">
  <h3>
    <a href="#excluding-tests" name="excluding-tests" class="pilcrow"></a>
Excluding tests
  </h3>
</div>
<p>As not every implementation can be fully compliant due to limitations of its underlying storage, some tests may be skipped. For example, to skip snapshot tests:</p>
<pre><code class="js">suite({
  <span class="hljs-comment">// ..</span>
  <span class="hljs-attr">snapshots</span>: <span class="hljs-literal">false</span>
})
</code></pre>
<p>This also serves as a signal to users of your implementation. The following options are available:</p>
<ul>
<li><code>bufferKeys</code>: set to <code>false</code> if binary keys are not supported by the underlying storage</li>
<li><code>seek</code>: set to <code>false</code> if your <code>iterator</code> does not implement <code>_seek</code></li>
<li><code>clear</code>: defaults to <code>false</code> until a next major release. Set to <code>true</code> if your implementation either implements <code>_clear()</code> itself or is suitable to use the default implementation of <code>_clear()</code> (which requires binary key support).</li>
<li><code>snapshots</code>: set to <code>false</code> if any of the following is true:
<ul>
<li>Reads don't operate on a <a href="#iterator.html">snapshot</a></li>
<li>Snapshots are created asynchronously</li>
</ul>
</li>
<li><code>createIfMissing</code> and <code>errorIfExists</code>: set to <code>false</code> if <code>db._open()</code> does not support these options.</li>
<li><code>legacyRange</code>: set to <code>false</code> if your iterator does not support the legacy <code>start</code> and <code>end</code> range options.</li>
</ul>
<p>This metadata will be moved to manifests (<code>db.supports</code>) in the future.</p>
<div class="pilwrap" id="setup-and-teardown">
  <h3>
    <a href="#setup-and-teardown" name="setup-and-teardown" class="pilcrow"></a>
Setup and teardown
  </h3>
</div>
<p>To perform (a)synchronous work before or after each test, you may define <code>setUp</code> and <code>tearDown</code> functions:</p>
<pre><code class="js">suite({
  <span class="hljs-comment">// ..</span>
  <span class="hljs-attr">setUp</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) </span>{
    t.end()
  },
  <span class="hljs-attr">tearDown</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) </span>{
    t.end()
  }
})
</code></pre>
<div class="pilwrap" id="reusing-testcommon">
  <h3>
    <a href="#reusing-testcommon" name="reusing-testcommon" class="pilcrow"></a>
Reusing <code>testCommon</code>
  </h3>
</div>
<p>The input to the test suite is a <code>testCommon</code> object. Should you need to reuse <code>testCommon</code> for your own (additional) tests, use the included utility to create a <code>testCommon</code> with defaults:</p>
<pre><code class="js"><span class="hljs-keyword">const</span> test = <span class="hljs-built_in">require</span>(<span class="hljs-string">'tape'</span>)
<span class="hljs-keyword">const</span> suite = <span class="hljs-built_in">require</span>(<span class="hljs-string">'abstract-leveldown/test'</span>)
<span class="hljs-keyword">const</span> YourDOWN = <span class="hljs-built_in">require</span>(<span class="hljs-string">'.'</span>)

<span class="hljs-keyword">const</span> testCommon = suite.common({
  <span class="hljs-attr">test</span>: test,
  <span class="hljs-attr">factory</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> YourDOWN()
  }
})

suite(testCommon)
</code></pre>
<p>The <code>testCommon</code> object will have all the properties describe above: <code>test</code>, <code>factory</code>, <code>setUp</code>, <code>tearDown</code> and the skip options. You might use it like so:</p>
<pre><code class="js">test(<span class="hljs-string">'setUp'</span>, testCommon.setUp)

test(<span class="hljs-string">'custom test'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) </span>{
  <span class="hljs-keyword">var</span> db = testCommon.factory()
  <span class="hljs-comment">// ..</span>
})

test(<span class="hljs-string">'another custom test'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) </span>{
  <span class="hljs-keyword">var</span> db = testCommon.factory()
  <span class="hljs-comment">// ..</span>
})

test(<span class="hljs-string">'tearDown'</span>, testCommon.tearDown)
</code></pre>
<div class="pilwrap" id="spread-the-word">
  <h2>
    <a href="#spread-the-word" name="spread-the-word" class="pilcrow"></a>
Spread The Word
  </h2>
</div>
<p>If you'd like to share your awesome implementation with the world, here's what you might want to do:</p>
<ul>
<li>Add an awesome badge to your <code>README</code>: <code>![level badge](https://leveljs.org/img/badge.svg)</code></li>
<li>Publish your awesome module to <a href="https://npmjs.org">npm</a></li>
<li>Send a Pull Request to <a href="https://github.com/Level/awesome">Level/awesome</a> to advertise your work!</li>
</ul>
<div class="pilwrap" id="install">
  <h2>
    <a href="#install" name="install" class="pilcrow"></a>
Install
  </h2>
</div>
<p>With <a href="https://npmjs.org">npm</a> do:</p>
<pre><code>npm install abstract-leveldown
</code></pre>
<div class="pilwrap" id="contributing">
  <h2>
    <a href="#contributing" name="contributing" class="pilcrow"></a>
Contributing
  </h2>
</div>
<p><a href="https://github.com/Level/abstract-leveldown"><code>Level/abstract-leveldown</code></a> is an <strong>OPEN Open Source Project</strong>. This means that:</p>
<blockquote>
<p>Individuals making significant and valuable contributions are given commit-access to the project to contribute as they see fit. This project is more like an open wiki than a standard guarded open source project.</p>
</blockquote>
<p>See the <a href="https://github.com/Level/community/blob/master/CONTRIBUTING.md">Contribution Guide</a> for more details.</p>
<div class="pilwrap" id="big-thanks">
  <h2>
    <a href="#big-thanks" name="big-thanks" class="pilcrow"></a>
Big Thanks
  </h2>
</div>
<p>Cross-browser Testing Platform and Open Source ♥ Provided by <a href="https://saucelabs.com">Sauce Labs</a>.</p>
<p><a href="https://saucelabs.com"><img src="./sauce-labs.svg" alt="Sauce Labs logo"></a></p>
<div class="pilwrap" id="donate">
  <h2>
    <a href="#donate" name="donate" class="pilcrow"></a>
Donate
  </h2>
</div>
<p>To sustain <a href="https://github.com/Level"><code>Level</code></a> and its activities, become a backer or sponsor on <a href="https://opencollective.com/level">Open Collective</a>. Your logo or avatar will be displayed on our 28+ <a href="https://github.com/Level">GitHub repositories</a> and <a href="https://www.npmjs.com/">npm</a> packages. 💖</p>
<div class="pilwrap" id="backers">
  <h3>
    <a href="#backers" name="backers" class="pilcrow"></a>
Backers
  </h3>
</div>
<p><a href="https://opencollective.com/level"><img src="https://opencollective.com/level/backers.svg?width=890" alt="Open Collective backers"></a></p>
<div class="pilwrap" id="sponsors">
  <h3>
    <a href="#sponsors" name="sponsors" class="pilcrow"></a>
Sponsors
  </h3>
</div>
<p><a href="https://opencollective.com/level"><img src="https://opencollective.com/level/sponsors.svg?width=890" alt="Open Collective sponsors"></a></p>
<div class="pilwrap" id="license">
  <h2>
    <a href="#license" name="license" class="pilcrow"></a>
License
  </h2>
</div>
<p><a href="LICENSE.md.html">MIT</a> © 2013-present Rod Vagg and <a href="CONTRIBUTORS.md.html">Contributors</a>.</p>
</div>
  </div>
</body>
</html>
